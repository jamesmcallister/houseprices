resources:
- name: source-code
  type: git
  source:
    uri: git@github.com:jamesmcallister/houseprices.git
    branch: concourse
    private_key: {{private_key}}

- name: pipeline-worker
  type: docker-image
  source:
    repository: "172.17.0.2:5000/pipeline-worker"
    insecure_registries: ["172.17.0.2:5000"]

jobs:
- name: main
  plan:
  - get: source-code
  - task: curl
    config:
      platform: linux
      image_resource:
        type: docker-image
        source:
          repository: debian
          tag: jessie-backports
      inputs:
      - name: source-code
      run:
        path: sh
        args:
        - -exc
        - |
         curl -vv http://"172.17.0.2:5000"
  - put: pipeline-worker
    params:
      build: source-code

- name: total
  plan:
  - get: source-code
  - get: pipeline-worker
  - task: hello
    config:
      platform: linux
      image: pipeline-worker
      inputs:
      - name: source-code
      run:
        path: echo
        args:
        - hello world

